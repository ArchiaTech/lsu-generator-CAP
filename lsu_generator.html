<!DOCTYPE html>
<html lang="fr">
<head>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéì G√©n√©rateur de Commentaires LSU - √âcole Primaire</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome CSS (fallback pour les ic√¥nes) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
<style>
        /* Barre de Navigation LSU */
        .nav-bar {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid #3498db;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            height: 70px;
        }

        .nav-logo {
            display: flex;
            align-items: center;
        }

        .logo-link {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            transition: all 0.3s;
        }

        .logo-link:hover {
            transform: scale(1.05);
            text-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
        }

        .logo-icon {
            font-size: 1.8em;
            margin-right: 10px;
        }

        .logo-text {
            background: linear-gradient(45deg, #3498db, #2ecc71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-menu {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .nav-link:hover::before {
            left: 100%;
        }

        .nav-link:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .nav-link.active {
            background: rgba(52, 152, 219, 0.3);
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
        }

        .nav-icon {
            font-size: 1.2em;
        }

        .nav-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
            gap: 4px;
        }

        .nav-toggle span {
            width: 25px;
            height: 3px;
            background: white;
            border-radius: 2px;
            transition: all 0.3s;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-menu {
                position: fixed;
                top: 70px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 70px);
                background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
                flex-direction: column;
                padding: 20px;
                transition: left 0.3s;
                gap: 10px;
            }

            .nav-menu.active {
                left: 0;
            }

            .nav-link {
                width: 100%;
                justify-content: center;
                padding: 15px;
                font-size: 1.1em;
            }

            .nav-toggle {
                display: flex;
            }

            .nav-toggle.active span:nth-child(1) {
                transform: rotate(45deg) translate(5px, 5px);
            }

            .nav-toggle.active span:nth-child(2) {
                opacity: 0;
            }

            .nav-toggle.active span:nth-child(3) {
                transform: rotate(-45deg) translate(7px, -6px);
            }
        }

        /* Animation d'entr√©e */
        @keyframes slideInDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .nav-bar {
            animation: slideInDown 0.5s ease-out;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Barre de menu */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
        }

        .nav-logo {
            font-size: 1.5em;
            font-weight: bold;
            color: #4CAF50;
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            text-decoration: none;
            color: #2c3e50;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 6px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link:hover, .nav-link.active {
            background: #4CAF50;
            color: white;
            transform: translateY(-2px);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
        }

        /* Indicateur de connexion */
        .connection-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .status-connected {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .status-disconnected {
            background: #ffebee;
            color: #c62828;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .indicator-green {
            background: #4CAF50;
        }

        .indicator-red {
            background: #f44336;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .form-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .section-title {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: white;
            border-radius: 6px;
            border: 1px solid #ddd;
            transition: background-color 0.2s;
        }

        .checkbox-item:hover {
            background-color: #f0f8ff;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        .level-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .level-btn {
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            text-align: center;
            font-size: 0.9em;
        }

        .level-btn.insufficient {
            background: #ffebee;
            color: #c62828;
            border: 2px solid #ffcdd2;
        }

        .level-btn.fragile {
            background: #fff3e0;
            color: #ef6c00;
            border: 2px solid #ffcc02;
        }

        .level-btn.satisfactory {
            background: #e8f5e8;
            color: #2e7d32;
            border: 2px solid #a5d6a7;
        }

        .level-btn.excellent {
            background: #e3f2fd;
            color: #1565c0;
            border: 2px solid #90caf9;
        }

        .level-btn.active {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .generate-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 20px;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .generate-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .comment-output {
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            min-height: 200px;
            font-size: 16px;
            line-height: 1.6;
            color: #2c3e50;
        }

        .comment-placeholder {
            color: #999;
            font-style: italic;
            text-align: center;
            padding: 40px 20px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e9ecef;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #4CAF50;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .copy-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 15px;
            transition: background-color 0.3s;
        }

        .copy-btn:hover {
            background: #1976D2;
        }

        .examples-section {
            grid-column: 1 / -1;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
            margin-top: 20px;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .example-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .example-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .example-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .example-text {
            color: #666;
            font-size: 0.9em;
            line-height: 1.4;
        }

        /* Page cach√©e */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Style pour la liste des √©l√®ves */
        .student-list {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px;
        }

        .student-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .student-card:hover {
            border-color: #4CAF50;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .student-info h3 {
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .student-info p {
            color: #666;
            font-size: 0.9em;
        }

        .student-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .btn-edit {
            background: #2196F3;
            color: white;
        }

        .btn-delete {
            background: #f44336;
            color: white;
        }

        .btn-view {
            background: #4CAF50;
            color: white;
        }

        .add-student-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
        }

        .close {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .nav-menu {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: white;
                flex-direction: column;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                padding: 20px;
            }

            .nav-menu.active {
                display: flex;
            }

            .mobile-menu-btn {
                display: block;
            }

            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
            
            .level-buttons {
                grid-template-columns: 1fr 1fr;
            }

            .connection-status {
                display: none;
            }
        }

        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification.error {
            background: #f44336;
        }

        /* Styles pour la recherche d'√©l√®ve */
        .search-container {
            position: relative;
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #ddd;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .search-results.show {
            display: block;
        }

        .search-result-item {
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            transition: background-color 0.2s;
        }

        .search-result-item:hover {
            background: #f8f9fa;
        }

        .search-result-item.selected {
            background: #e3f2fd;
        }

        .student-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .student-info {
            flex: 1;
        }

        .student-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .student-details {
            font-size: 0.85em;
            color: #666;
        }

        .form-help {
            color: #666;
            font-size: 0.85em;
            margin-top: 5px;
            font-style: italic;
        }
    
        /* Am√©lioration de la compatibilit√© des ic√¥nes */
        .icon-fallback {
            display: inline-block;
            width: 1em;
            height: 1em;
            text-align: center;
            line-height: 1;
        }

        /* Fallback pour les emojis qui ne s'affichent pas */
        .btn .emoji-icon {
            display: inline-block;
            margin-right: 5px;
        }

        /* Styles pour les ic√¥nes Font Awesome en fallback */
        .fa-fallback {
            display: none;
        }

        /* Am√©lioration de l'affichage des boutons avec ic√¥nes */
        .btn-with-icon {
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        /* Am√©lioration de l'affichage des emojis */
        .emoji-icon {
            font-size: 1.1em;
            vertical-align: middle;
        }

        /* Styles pour les ic√¥nes Font Awesome */
        .icon-fa {
            font-size: 1.1em;
            width: 20px;
            text-align: center;
            margin-right: 8px;
        }

        /* Am√©lioration des boutons avec ic√¥nes */
        .btn-with-icon {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border-radius: 8px;
            border: none;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            text-decoration: none;
        }

        .btn-with-icon:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* Styles sp√©cifiques pour les boutons d'action */
        .btn-with-icon.btn-success {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            color: white;
        }

        .btn-with-icon.btn-info {
            background: linear-gradient(135deg, #17a2b8, #117a8b);
            color: white;
        }

        .btn-with-icon.btn-warning {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            color: #212529;
        }

        .btn-with-icon.btn-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }

        .btn-with-icon.btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
        }

        .btn-with-icon.btn-secondary {
            background: linear-gradient(135deg, #6c757d, #545b62);
            color: white;
        }

        /* Styles pour le bloc commentaire am√©lior√© */
        .comment-content {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #333;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .comment-content p {
            margin-bottom: 0;
        }

        .card.shadow-lg {
            transition: all 0.3s ease;
        }

        .card.shadow-lg:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15) !important;
        }

        .btn {
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* Couleurs dynamiques selon le niveau */
        .level-excellent {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%) !important;
            color: white !important;
        }

        .level-satisfactory {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%) !important;
            color: white !important;
        }

        .level-fragile {
            background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%) !important;
            color: white !important;
        }

        .level-insufficient {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%) !important;
            color: white !important;
        }

        /* Badge de niveau */
        .badge-excellent {
            background: #4CAF50 !important;
            color: white !important;
        }

        .badge-satisfactory {
            background: #2196F3 !important;
            color: white !important;
        }

        .badge-fragile {
            background: #FF9800 !important;
            color: white !important;
        }

        .badge-insufficient {
            background: #f44336 !important;
            color: white !important;
        }

        /* Responsive pour les statistiques */
        @media (max-width: 768px) {
            .row .col-md-4 {
                margin-bottom: 1rem;
            }
            
            .card-footer .btn {
                width: 100%;
                margin-bottom: 0.5rem;
            }
        }

        /* Animation pour l'apparition du commentaire */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .comment-card-visible {
            animation: fadeInUp 0.5s ease-out;
        }

        /* Toast notification */
        .toast-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 10000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .toast-notification.show {
            transform: translateX(0);
        }

        .toast-notification.success {
            background: #4CAF50;
        }

        .toast-notification.error {
            background: #f44336;
        }
</style>
    <!-- Styles CSS pour la sidebar -->
<style>
    /* Animation d'entr√©e pour la sidebar */
    @keyframes slideIn {
        from { transform: translateX(-100%); }
        to { transform: translateX(0); }
    }

    /* Highlight pour la page active */
    .nav-link.active {
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #fbbf24;
    }

    /* Animation de survol am√©lior√©e */
    .nav-link:hover {
        transform: translateX(4px);
    }

    /* Responsive design */
    @media (max-width: 640px) {
        #sidebar {
            transform: translateX(-100%);
        }
        
        #sidebar.open {
            transform: translateX(0);
        }
    }

    /* Ajustement du contenu principal pour la sidebar */
    .main-content {
        margin-left: 0;
        transition: margin-left 0.3s ease;
    }

    @media (min-width: 640px) {
        .main-content {
            margin-left: 256px; /* w-64 = 16rem = 256px */
        }
    }
</style>
    <style>
    /* Styles pour les ic√¥nes Font Awesome */
    .btn-with-icon i {
        margin-right: 8px;
        font-size: 14px;
    }
    
    .btn-with-icon:hover i {
        transform: scale(1.1);
        transition: transform 0.2s ease;
    }
    
    /* Masquer les ic√¥nes de fallback */
    .fa-fallback {
        display: none;
    }
    
    /* Ic√¥nes sp√©cifiques */
    .btn-with-icon .fa-edit { color: #007bff; }
    .btn-with-icon .fa-trash { color: #dc3545; }
    .btn-with-icon .fa-plus { color: #28a745; }
    .btn-with-icon .fa-save { color: #17a2b8; }
    .btn-with-icon .fa-magic { color: #6f42c1; }
    .btn-with-icon .fa-comments { color: #fd7e14; }
    .btn-with-icon .fa-chart-bar { color: #20c997; }
    .btn-with-icon .fa-image { color: #e83e8c; }
    .btn-with-icon .fa-eye { color: #6c757d; }
    .btn-with-icon .fa-download { color: #28a745; }
    .btn-with-icon .fa-upload { color: #ffc107; }
    .btn-with-icon .fa-times { color: #6c757d; }
    .btn-with-icon .fa-home { color: #007bff; }
    .btn-with-icon .fa-bullseye { color: #dc3545; }
    .btn-with-icon .fa-users { color: #28a745; }
    .btn-with-icon .fa-tachometer-alt { color: #17a2b8; }
    </style>
</head>
<body class="main-content">
    <!-- Barre de navigation lat√©rale - √âCOLE DU CAP -->
<div id="sidebar" class="fixed left-0 top-0 h-full w-64 bg-gradient-to-b from-indigo-500 to-blue-500 text-white shadow-xl z-50 transition-all duration-300 transform -translate-x-full sm:translate-x-0">
    
    <!-- Logo et nom de l'√©cole -->
    <div class="p-6 border-b border-indigo-400/30">
        <div class="flex items-center space-x-3">
            <div class="text-3xl">üè´</div>
            <div>
                <h1 class="text-xl font-bold">√âCOLE DU CAP</h1>
                <p class="text-xs text-indigo-100">Navigation principale</p>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="mt-6 px-4">
        <ul class="space-y-2">
            <!-- Accueil -->
            <li>
                <a href="index.html" id="nav-accueil" class="nav-link flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-200 hover:bg-white/10 hover:shadow-md group">
                    <span class="text-xl">üè†</span>
                    <span class="font-medium">Accueil</span>
                    <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </div>
                </a>
            </li>

            <!-- G√©n√©rateur LSU -->
            <li>
                <a href="lsu_generator.html" id="nav-lsu" class="nav-link flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-200 hover:bg-white/10 hover:shadow-md group">
                    <span class="text-xl">üéì</span>
                    <span class="font-medium">G√©n√©rateur LSU</span>
                    <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </div>
                </a>
            </li>

            <!-- Profils √©l√®ves -->
            <li>
                <a href="profils_eleves.html" id="nav-profils" class="nav-link flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-200 hover:bg-white/10 hover:shadow-md group">
                    <span class="text-xl">üë®‚Äçüéì</span>
                    <span class="font-medium">Profils √©l√®ves</span>
                    <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </div>
                </a>
            </li>

            <!-- Tableau de bord -->
            <li>
                <a href="dashboard.html" id="nav-dashboard" class="nav-link flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-200 hover:bg-white/10 hover:shadow-md group">
                    <span class="text-xl">üìä</span>
                    <span class="font-medium">Tableau de bord</span>
                    <div class="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </div>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Footer de la sidebar -->
    <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-indigo-400/30">
        <div class="text-center text-xs text-indigo-100">
            <p>¬© 2025 √âCOLE DU CAP</p>
            <p class="mt-1">Syst√®me de gestion √©ducative</p>
        </div>
    </div>
</div>

<!-- Bouton burger pour mobile -->
<div id="sidebar-toggle" class="fixed top-4 left-4 z-50 sm:hidden bg-indigo-500 text-white p-2 rounded-lg shadow-lg">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
    </svg>
</div>

<!-- Overlay pour mobile -->
<div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-40 sm:hidden hidden"></div>
    
    <!-- Barre de Navigation LSU -->
    <nav class="nav-bar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="index.html" class="logo-link">
                    <span class="logo-icon"><i class="fas fa-graduation-cap icon-fa"></i><i class="fas fa-graduation-cap fa-fallback"></i></span>
                    <span class="logo-text">LSU Pro</span>
                </a>
            </div>
            
            <div class="nav-menu" id="navMenu">
                <a href="index.html" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-home icon-fa"></i><i class="fas fa-home fa-fallback"></i></span>
                    Accueil
                </a>
                <a href="improved_lsu_generator.html" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-file-alt icon-fa"></i><i class="fas fa-file-alt fa-fallback"></i></span>
                    G√©n√©rateur LSU
                </a>
                <a href="student_profile_page.html" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-user icon-fa"></i><i class="fas fa-user fa-fallback"></i></span>
                    Profils √âl√®ves
                </a>
                <a href="photos_classe_pro.html" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-camera icon-fa"></i><i class="fas fa-camera fa-fallback"></i></span>
                    Photos Classe
                </a>
                <a href="lsu_connection_test.html" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-cog icon-fa"></i><i class="fas fa-cog fa-fallback"></i></span>
                    Tests Connexion
                </a>
                <a href="test_navigation.html" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-compass icon-fa"></i><i class="fas fa-compass fa-fallback"></i></span>
                    Navigation
                </a>
            </div>
            
            <div class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Barre de menu -->
    <nav class="navbar">
        <div class="navbar-logo">üè´ LSU G√©nies</div>
        <div class="navbar-menu">
            <a class="navbar-link" href="index.html"><span>üè†</span>Accueil</a>
            <a class="navbar-link active" href="lsu_generator.html"><span>üéì</span>G√©n√©rateur LSU</a>
            <a class="navbar-link" href="students.html"><span>üë©‚Äçüè´</span>Profils √©l√®ves</a>
            <a class="navbar-link" href="dashboard.html"><span>üìä</span>Tableau de bord</a>
        </div>
    </nav>

    <!-- Page G√©n√©rateur -->
    <div id="generatorPage" class="page active">
        <div class="container">
            <div class="header">
                <h1>üéì G√©n√©rateur de Commentaires LSU</h1>
                <p>Cr√©ez des appr√©ciations personnalis√©es pour l'√©cole primaire</p>
            </div>

            <div class="main-content">
                <div class="form-section">
                    <h2 class="section-title">üìù Informations sur l'√©l√®ve</h2>
                    
                    <!-- Section de recherche d'√©l√®ve -->
                    <div class="form-group">
                        <label for="studentSearch">üîç Rechercher un √©l√®ve :</label>
                        <div class="search-container">
                            <input type="text" id="studentSearch" placeholder="Tapez le nom d'un √©l√®ve..." autocomplete="off">
                            <div id="searchResults" class="search-results"></div>
                        </div>
                        <small class="form-help">S√©lectionnez un √©l√®ve pour remplir automatiquement les champs</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="studentName">Pr√©nom de l'√©l√®ve :</label>
                        <input type="text" id="studentName" placeholder="Ex: L√©a, Thomas, Sarah...">
                    </div>

                    <div class="form-group">
                        <label for="studentLevel">Niveau scolaire :</label>
                        <select id="studentLevel">
                            <option value="">S√©lectionner un niveau</option>
                            <option value="CP">CP - Cours Pr√©paratoire</option>
                            <option value="CE1">CE1 - Cours √âl√©mentaire 1√®re ann√©e</option>
                            <option value="CE2">CE2 - Cours √âl√©mentaire 2√®me ann√©e</option>
                            <option value="CM1">CM1 - Cours Moyen 1√®re ann√©e</option>
                            <option value="CM2">CM2 - Cours Moyen 2√®me ann√©e</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="period">P√©riode d'√©valuation :</label>
                        <select id="period">
                            <option value="">S√©lectionner une p√©riode</option>
                            <option value="1er trimestre">1er trimestre</option>
                            <option value="2√®me trimestre">2√®me trimestre</option>
                            <option value="3√®me trimestre">3√®me trimestre</option>
                            <option value="1er semestre">1er semestre</option>
                            <option value="2√®me semestre">2√®me semestre</option>
                            <option value="bilan annuel">Bilan annuel</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Niveau g√©n√©ral de l'√©l√®ve :</label>
                        <div class="level-buttons">
                            <button type="button" class="level-btn insufficient" data-level="insufficient">
                                Ma√Ætrise insuffisante
                            </button>
                            <button type="button" class="level-btn fragile" data-level="fragile">
                                Ma√Ætrise fragile
                            </button>
                            <button type="button" class="level-btn satisfactory" data-level="satisfactory">
                                Ma√Ætrise satisfaisante
                            </button>
                            <button type="button" class="level-btn excellent" data-level="excellent">
                                Tr√®s bonne ma√Ætrise
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Points forts observ√©s :</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="participation" value="participation">
                                <label for="participation">Participation active</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="autonomie" value="autonomie">
                                <label for="autonomie">Autonomie</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="progres" value="progres">
                                <label for="progres">Progr√®s constants</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="creativite" value="creativite">
                                <label for="creativite">Cr√©ativit√©</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="ecoute" value="ecoute">
                                <label for="ecoute">Bonne √©coute</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="entraide" value="entraide">
                                <label for="entraide">Esprit d'entraide</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="specificPoints">Points sp√©cifiques √† mentionner :</label>
                        <textarea id="specificPoints" rows="3" placeholder="Mentionnez des √©l√©ments particuliers √† cet √©l√®ve..."></textarea>
                    </div>

                    <button type="button" class="generate-btn" onclick="generateComment()"" class="btn-with-icon"><i class="fas fa-magic"></i>G√©n√©rer le commentaire
                    </button>
                </div>

                <div class="result-section">
                    <h2 class="section-title">üìã Commentaire g√©n√©r√©</h2>
                    
                    <!-- Statistiques -->
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <div class="card text-center bg-primary text-white">
                                <div class="card-body py-2">
                                    <div class="h4 mb-0" id="generatedCount">0</div>
                                    <small>G√©n√©r√©s</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card text-center bg-success text-white">
                                <div class="card-body py-2">
                                    <div class="h4 mb-0" id="wordCount">0</div>
                                    <small>Mots</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card text-center bg-info text-white">
                                <div class="card-body py-2">
                                    <div class="h4 mb-0" id="charCount">0</div>
                                    <small>Caract√®res</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Encadr√© du commentaire -->
                    <div class="card shadow-lg border-0" id="commentCard" style="display: none;">
                        <div class="card-header" id="commentHeader">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-user-graduate me-2"></i>
                                    Commentaire pour <span id="studentDisplayName">l'√©l√®ve</span>
                                </h5>
                                <div class="badge" id="levelBadge"></div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="comment-content" id="commentOutput">
                                <div class="text-muted text-center py-4">
                                    <i class="fas fa-magic fa-2x mb-3"></i>
                                    <p>Remplissez le formulaire et cliquez sur "G√©n√©rer le commentaire" pour obtenir une appr√©ciation personnalis√©e...</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer bg-light">
                            <div class="d-flex justify-content-center gap-2 flex-wrap">
                                <button type="button" class="btn btn-success" onclick="copyComment()" id="copyBtn" style="display: none;">
                                    <i class="fas fa-copy me-2"></i>üìã Copier
                                </button>
                                <button type="button" class="btn btn-primary" onclick="exportToPDF()" id="exportBtn" style="display: none;">
                                    <i class="fas fa-file-pdf me-2"></i>üìÑ Exporter PDF
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Placeholder initial -->
                    <div class="card shadow border-0" id="commentPlaceholder">
                        <div class="card-body text-center py-5">
                            <i class="fas fa-magic fa-3x text-muted mb-3"></i>
                            <h5 class="text-muted">Aucun commentaire g√©n√©r√©</h5>
                            <p class="text-muted">Remplissez le formulaire et cliquez sur "G√©n√©rer le commentaire" pour commencer.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="examples-section">
                <h2 class="section-title">üí° Exemples rapides</h2>
                <div class="examples-grid">
                    <div class="example-card" onclick="loadExample('excellent')">
                        <div class="example-title">√âl√®ve excellent</div>
                        <div class="example-text">Tr√®s bonne ma√Ætrise, participation active, autonomie remarquable...</div>
                    </div>
                    <div class="example-card" onclick="loadExample('progres')">
                        <div class="example-title">√âl√®ve en progr√®s</div>
                        <div class="example-text">Progr√®s constants, efforts soutenus, motivation grandissante...</div>
                    </div>
                    <div class="example-card" onclick="loadExample('encourage')">
                        <div class="example-title">√âl√®ve √† encourager</div>
                        <div class="example-text">Potentiel √† d√©velopper, besoins d'accompagnement, points positifs...</div>
                    </div>
                    <div class="example-card" onclick="loadExample('comportement')">
                        <div class="example-title">Focus comportement</div>
                        <div class="example-text">Attitude positive, respect des r√®gles, esprit d'√©quipe...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Page √âl√®ves -->
    <div id="studentsPage" class="page">
        <div class="student-list">
            <h1>üë• Gestion des √âl√®ves</h1>
            <button class="add-student-btn" onclick="openAddStudentModal()"" class="btn-with-icon"><i class="fas fa-plus"></i>Ajouter un √©l√®ve</button>
            
            <div id="studentsList">
                <!-- Liste dynamique des √©l√®ves -->
            </div>
        </div>
    </div>

    <!-- Page Param√®tres -->
    <div id="settingsPage" class="page">
        <div class="student-list">
            <h1>‚öôÔ∏è Param√®tres de Connexion</h1>
            
            <div class="form-section">
                <h2 class="section-title">üîó Configuration N8N</h2>
                
                <div class="form-group">
                    <label for="n8nUrl">URL du webhook N8N :</label>
                    <input type="url" id="n8nUrl" placeholder="https://your-n8n-instance.com/webhook/lsu">
                </div>

                <div class="form-group">
                    <label for="apiKey">Cl√© API (optionnelle) :</label>
                    <input type="password" id="apiKey" placeholder="Votre cl√© API si n√©cessaire">
                </div>

                <h2 class="section-title">ü§ñ IA Locale</h2>
                
                <div class="form-group">
                    <label for="aiUrl">URL de l'IA locale :</label>
                    <input type="url" id="aiUrl" placeholder="http://localhost:11434/api/generate">
                </div>

                <div class="form-group">
                    <label for="aiModel">Mod√®le IA :</label>
                    <select id="aiModel">
                        <option value="llama2">Llama 2</option>
                        <option value="mistral">Mistral</option>
                        <option value="codellama">Code Llama</option>
                        <option value="custom">Personnalis√©</option>
                    </select>
                </div>

                <button class="generate-btn" onclick="testConnections()"" class="btn-with-icon"><i class="fas fa-search"></i>Tester les connexions</button>
                <button class="generate-btn" onclick="saveSettings()" style="margin-top: 10px;"" class="btn-with-icon"><i class="fas fa-save"></i>Sauvegarder</button>
            </div>
        </div>
    </div>

    <!-- Modal Ajout √âl√®ve -->
    <div id="addStudentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAddStudentModal()">&times;</span>
            <h2>‚ûï Ajouter un nouvel √©l√®ve</h2>
            
            <div class="form-group">
                <label for="newStudentName">Pr√©nom :</label>
                <input type="text" id="newStudentName" placeholder="Pr√©nom de l'√©l√®ve">
            </div>

            <div class="form-group">
                <label for="newStudentLastName">Nom :</label>
                <input type="text" id="newStudentLastName" placeholder="Nom de famille">
            </div>

            <div class="form-group">
                <label for="newStudentLevel">Niveau :</label>
                <select id="newStudentLevel">
                    <option value="CP">CP - Cours Pr√©paratoire</option>
                    <option value="CE1">CE1 - Cours √âl√©mentaire 1√®re ann√©e</option>
                    <option value="CE2">CE2 - Cours √âl√©mentaire 2√®me ann√©e</option>
                    <option value="CM1">CM1 - Cours Moyen 1√®re ann√©e</option>
                    <option value="CM2">CM2 - Cours Moyen 2√®me ann√©e</option>
                </select>
            </div>

            <div class="form-group">
                <label for="newStudentBirthDate">Date de naissance :</label>
                <input type="date" id="newStudentBirthDate">
            </div>

            <button class="generate-btn" onclick="addStudent()"" class="btn-with-icon"><i class="fas fa-plus"></i>Ajouter l'√©l√®ve</button>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Script pour la navigation
        document.addEventListener('DOMContentLoaded', function() {
            const navToggle = document.getElementById('navToggle');
            const navMenu = document.getElementById('navMenu');
            const navLinks = document.querySelectorAll('.nav-link');
            
            // Toggle menu mobile
            navToggle.addEventListener('click', function() {
                navMenu.classList.toggle('active');
                navToggle.classList.toggle('active');
            });
            
            // Fermer le menu en cliquant sur un lien
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    navMenu.classList.remove('active');
                    navToggle.classList.remove('active');
                });
            });
            
            // Marquer le lien actif
            const currentPage = window.location.pathname.split('/').pop() || 'index.html';
            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentPage) {
                    link.classList.add('active');
                }
            });
            
            // Fermer le menu en cliquant √† l'ext√©rieur
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.nav-bar')) {
                    navMenu.classList.remove('active');
                    navToggle.classList.remove('active');
                }
            });
        });

        let generatedCount = 0;
        let selectedLevel = '';
        let students = JSON.parse(localStorage.getItem('students')) || [];

        // Donn√©es d'√©l√®ves pour la recherche (exemple)
        const eleves = [
            {
                prenom: "L√©a",
                niveau: "CE2",
                periode: "Trimestre 2",
                niveauGeneral: "Tr√®s bonne ma√Ætrise",
                pointsForts: ["Participation active", "Cr√©ativit√©", "Autonomie"]
            },
            {
                prenom: "Thomas",
                niveau: "CM1",
                periode: "Trimestre 1",
                niveauGeneral: "Ma√Ætrise satisfaisante",
                pointsForts: ["Bonne √©coute", "Esprit d'entraide"]
            },
            {
                prenom: "Emma",
                niveau: "CP",
                periode: "Trimestre 3",
                niveauGeneral: "Ma√Ætrise fragile",
                pointsForts: ["Progr√®s constants", "Participation active"]
            },
            {
                prenom: "Lucas",
                niveau: "CE1",
                periode: "Trimestre 2",
                niveauGeneral: "Tr√®s bonne ma√Ætrise",
                pointsForts: ["Autonomie", "Cr√©ativit√©", "Esprit d'entraide"]
            },
            {
                prenom: "Sarah",
                niveau: "CM2",
                periode: "Trimestre 1",
                niveauGeneral: "Ma√Ætrise satisfaisante",
                pointsForts: ["Bonne √©coute", "Progr√®s constants"]
            },
            {
                prenom: "Hugo",
                niveau: "CP",
                periode: "Trimestre 2",
                niveauGeneral: "Ma√Ætrise insuffisante",
                pointsForts: ["Participation active"]
            }
        ];

        // Configuration par d√©faut
        let config = {
            n8nUrl: '',
            apiKey: '',
            aiUrl: 'http://localhost:11434/api/generate',
            aiModel: 'llama2'
        };

        // Navigation
        function showPage(pageName) {
            // Masquer toutes les pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Masquer les liens actifs
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Afficher la page s√©lectionn√©e
            document.getElementById(pageName + 'Page').classList.add('active');
            
            // Activer le lien correspondant
            event.target.classList.add('active');

            // Charger les donn√©es si n√©cessaire
            if (pageName === 'students') {
                loadStudentsList();
            } else if (pageName === 'settings') {
                loadSettings();
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('navMenu');
            menu.classList.toggle('active');
        }

        // Gestion de la s√©lection du niveau
        document.querySelectorAll('.level-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                selectedLevel = this.dataset.level;
            });
        });

        // Mod√®les de commentaires pour √©cole primaire
        const commentTemplates = {
            insufficient: {
                starters: [
                    "{name} rencontre encore des difficult√©s ce {period}.",
                    "{name} a besoin d'un accompagnement renforc√© ce {period}.",
                    "{name} progresse lentement mais s√ªrement ce {period}.",
                    "{name} n√©cessite un soutien particulier ce {period}."
                ],
                strengths: {
                    participation: "malgr√© une participation timide mais sinc√®re",
                    autonomie: "avec un besoin d'aide dans l'organisation",
                    progres: "en montrant quelques signes d'am√©lioration",
                    creativite: "avec des id√©es int√©ressantes √† d√©velopper",
                    ecoute: "en √©tant attentif/ve aux consignes",
                    entraide: "en acceptant l'aide de ses camarades"
                },
                encouragements: [
                    "Il/elle doit pers√©v√©rer dans ses efforts pour progresser.",
                    "Un travail r√©gulier √† la maison l'aiderait √† consolider ses acquis.",
                    "Je l'encourage √† poser plus de questions en cas de difficult√©.",
                    "Avec patience et encouragements, les progr√®s viendront."
                ]
            },
            fragile: {
                starters: [
                    "{name} montre des progr√®s fragiles ce {period}.",
                    "{name} est sur la bonne voie ce {period}, mais doit consolider ses acquis.",
                    "{name} fait des efforts ce {period} qui commencent √† porter leurs fruits.",
                    "{name} √©volue positivement ce {period} avec quelques h√©sitations."
                ],
                strengths: {
                    participation: "en participant de plus en plus aux √©changes",
                    autonomie: "en gagnant progressivement en autonomie",
                    progres: "en montrant une belle progression",
                    creativite: "en apportant des id√©es originales",
                    ecoute: "en √©tant √† l'√©coute des consignes",
                    entraide: "en aidant parfois ses camarades"
                },
                encouragements: [
                    "Il/elle doit maintenir ses efforts pour stabiliser ses acquis.",
                    "Une pratique r√©guli√®re l'aiderait √† prendre confiance.",
                    "Je l'encourage √† continuer sur cette lanc√©e positive.",
                    "La pers√©v√©rance sera la cl√© de sa r√©ussite."
                ]
            },
            satisfactory: {
                starters: [
                    "{name} r√©alise un {period} satisfaisant.",
                    "{name} montre de bons r√©sultats ce {period}.",
                    "{name} a fourni un travail de qualit√© ce {period}.",
                    "{name} atteint les objectifs fix√©s ce {period}."
                ],
                strengths: {
                    participation: "en participant activement aux activit√©s",
                    autonomie: "en faisant preuve d'une bonne autonomie",
                    progres: "en progressant de mani√®re constante",
                    creativite: "en apportant cr√©ativit√© et originalit√©",
                    ecoute: "en √©tant tr√®s attentif/ve en classe",
                    entraide: "en aidant volontiers ses camarades"
                },
                encouragements: [
                    "Il/elle peut viser encore plus haut avec un peu plus d'ambition.",
                    "Je l'encourage √† approfondir certains sujets qui l'int√©ressent.",
                    "Il/elle a les capacit√©s pour atteindre l'excellence.",
                    "Continuez ainsi, les r√©sultats sont encourageants !"
                ]
            },
            excellent: {
                starters: [
                    "{name} r√©alise un {period} remarquable.",
                    "{name} atteint un excellent niveau ce {period}.",
                    "{name} fait preuve d'une tr√®s belle ma√Ætrise ce {period}.",
                    "{name} se distingue par ses excellents r√©sultats ce {period}."
                ],
                strengths: {
                    participation: "en s'investissant pleinement dans toutes les activit√©s",
                    autonomie: "en faisant preuve d'une autonomie exemplaire",
                    progres: "en progressant de fa√ßon spectaculaire",
                    creativite: "en d√©veloppant des approches cr√©atives remarquables",
                    ecoute: "en √©tant d'une attention soutenue",
                    entraide: "en √©tant un pilier d'entraide pour la classe"
                },
                encouragements: [
                    "Il/elle peut servir d'exemple √† ses camarades.",
                    "Je l'encourage √† continuer √† explorer ses passions.",
                    "Il/elle a toutes les capacit√©s pour r√©ussir brillamment.",
                    "F√©licitations pour ce parcours exemplaire !"
                ]
            }
        };

        // G√©n√©ration de commentaires avec IA locale
        async function generateComment() {
            const name = document.getElementById('studentName').value || 'L\'√©l√®ve';
            const level = document.getElementById('studentLevel').value;
            const period = document.getElementById('period').value || 'cette p√©riode';
            const specificPoints = document.getElementById('specificPoints').value;

            if (!selectedLevel) {
                showNotification('Veuillez s√©lectionner un niveau de ma√Ætrise', 'error');
                return;
            }

            // Tentative de g√©n√©ration avec IA locale
            const aiComment = await generateWithAI(name, level, period, selectedLevel, specificPoints);
            
            if (aiComment) {
                displayComment(aiComment);
                showNotification('Commentaire g√©n√©r√© avec l\'IA locale !', 'success');
            } else {
                // Fallback sur g√©n√©ration locale
                generateLocalComment();
                showNotification('Commentaire g√©n√©r√© localement (IA non disponible)', 'warning');
            }
        }

        // Chargement des param√®tres depuis l'URL
        function loadUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('name');
            const level = urlParams.get('level');
            const fromProfile = urlParams.get('fromProfile');

            if (name) {
                document.getElementById('studentName').value = name;
            }
            if (level) {
                document.getElementById('studentLevel').value = level;
            }
            if (fromProfile) {
                showNotification('Donn√©es charg√©es depuis le profil √©l√®ve', 'success');
            }
        }

        async function generateWithAI(name, level, period, selectedLevel, specificPoints) {
            try {
                const settings = loadSettings();
                if (!settings.aiUrl) return null;

                const selectedStrengths = [];
                document.querySelectorAll('.checkbox-item input[type="checkbox"]:checked').forEach(checkbox => {
                    selectedStrengths.push(checkbox.value);
                });

                const prompt = `G√©n√®re un commentaire LSU personnalis√© pour un √©l√®ve de ${level} nomm√© ${name}.
                P√©riode: ${period}
                Niveau de ma√Ætrise: ${selectedLevel}
                Points forts: ${selectedStrengths.join(', ')}
                Notes sp√©cifiques: ${specificPoints}
                
                Le commentaire doit √™tre bienveillant, constructif et adapt√© √† l'√©cole primaire.
                Limite: 150 mots maximum.`;

                const response = await fetch(settings.aiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: settings.aiModel,
                        prompt: prompt,
                        stream: false
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    return data.response || null;
                }
            } catch (error) {
                console.error('Erreur IA:', error);
            }
            return null;
        }

        function generateLocalComment() {
            const name = document.getElementById('studentName').value || 'L\'√©l√®ve';
            const level = document.getElementById('studentLevel').value;
            const period = document.getElementById('period').value || 'cette p√©riode';
            const specificPoints = document.getElementById('specificPoints').value;

            const template = commentTemplates[selectedLevel];
            
            let comment = '';
            
            // Phrase d'introduction
            const starter = template.starters[Math.floor(Math.random() * template.starters.length)];
            comment += starter.replace('{name}', name).replace('{period}', period);

            // Points forts
            const selectedStrengths = [];
            document.querySelectorAll('.checkbox-item input[type="checkbox"]:checked').forEach(checkbox => {
                if (template.strengths[checkbox.value]) {
                    selectedStrengths.push(template.strengths[checkbox.value]);
                }
            });

            if (selectedStrengths.length > 0) {
                comment += ' ' + selectedStrengths.join(', ') + '.';
            }

            // Points sp√©cifiques
            if (specificPoints.trim()) {
                comment += ' ' + specificPoints.trim();
                if (!specificPoints.endsWith('.')) comment += '.';
            }

            // Encouragement
            const encouragement = template.encouragements[Math.floor(Math.random() * template.encouragements.length)];
            comment += ' ' + encouragement;

            displayComment(comment);
        }

        function displayComment(comment) {
            // Masquer le placeholder et afficher la carte
            document.getElementById('commentPlaceholder').style.display = 'none';
            const commentCard = document.getElementById('commentCard');
            commentCard.style.display = 'block';
            commentCard.classList.add('comment-card-visible');
            
            // Mettre √† jour le contenu du commentaire
            const output = document.getElementById('commentOutput');
            output.innerHTML = `<p>${comment}</p>`;
            
            // Mettre √† jour l'en-t√™te avec les informations de l'√©l√®ve
            const name = document.getElementById('studentName').value || 'l\'√©l√®ve';
            const level = document.getElementById('studentLevel').value || '';
            const period = document.getElementById('period').value || 'cette p√©riode';
            
            document.getElementById('studentDisplayName').textContent = name;
            
            // Mettre √† jour le badge de niveau avec couleur dynamique
            const levelBadge = document.getElementById('levelBadge');
            const levelLabels = {
                'excellent': 'TBM',
                'satisfactory': 'MS',
                'fragile': 'MF',
                'insufficient': 'MI'
            };
            
            levelBadge.textContent = levelLabels[selectedLevel] || selectedLevel;
            levelBadge.className = `badge badge-${selectedLevel}`;
            
            // Appliquer la couleur dynamique √† l'en-t√™te
            const commentHeader = document.getElementById('commentHeader');
            commentHeader.className = `card-header level-${selectedLevel}`;
            
            // Mise √† jour des statistiques
            generatedCount++;
            updateStats(comment);
            
            // Afficher les boutons
            document.getElementById('copyBtn').style.display = 'inline-block';
            document.getElementById('exportBtn').style.display = 'inline-block';
        }

        function updateStats(comment) {
            document.getElementById('generatedCount').textContent = generatedCount;
            document.getElementById('wordCount').textContent = comment.split(' ').length;
            document.getElementById('charCount').textContent = comment.length;
        }

        function copyComment() {
            const comment = document.getElementById('commentOutput').textContent;
            navigator.clipboard.writeText(comment).then(() => {
                showToastNotification('Commentaire copi√© dans le presse-papiers !', 'success');
            }).catch(() => {
                showToastNotification('Erreur lors de la copie', 'error');
            });
        }

        function exportToPDF() {
            const name = document.getElementById('studentName').value || 'l\'√©l√®ve';
            const level = document.getElementById('studentLevel').value || '';
            const period = document.getElementById('period').value || 'cette p√©riode';
            const comment = document.getElementById('commentOutput').textContent;
            
            // Cr√©er une nouvelle fen√™tre pour l'impression
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
    <script src="https://cdn.tailwindcss.com"></script>
                    <title>Commentaire LSU - ${name}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 40px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .comment { 
                            background: #f8f9fa; 
                            padding: 20px; 
                            border-radius: 8px; 
                            border-left: 4px solid #667eea;
                            line-height: 1.6;
                        }
                        .info { 
                            background: #e3f2fd; 
                            padding: 15px; 
                            border-radius: 8px; 
                            margin-bottom: 20px;
                        }
                        @media print {
                            body { margin: 20px; }
                        }
                    </style>
                    <!-- Styles CSS pour la sidebar -->
<style>
    /* Animation d'entr√©e pour la sidebar */
    @keyframes slideIn {
        from { transform: translateX(-100%); }
        to { transform: translateX(0); }
    }

    /* Highlight pour la page active */
    .nav-link.active {
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #fbbf24;
    }

    /* Animation de survol am√©lior√©e */
    .nav-link:hover {
        transform: translateX(4px);
    }

    /* Responsive design */
    @media (max-width: 640px) {
        #sidebar {
            transform: translateX(-100%);
        }
        
        #sidebar.open {
            transform: translateX(0);
        }
    }

    /* Ajustement du contenu principal pour la sidebar */
    .main-content {
        margin-left: 0;
        transition: margin-left 0.3s ease;
    }

    @media (min-width: 640px) {
        .main-content {
            margin-left: 256px; /* w-64 = 16rem = 256px */
        }
    }
</style>
    <style>
    /* Styles pour les ic√¥nes Font Awesome */
    .btn-with-icon i {
        margin-right: 8px;
        font-size: 14px;
    }
    
    .btn-with-icon:hover i {
        transform: scale(1.1);
        transition: transform 0.2s ease;
    }
    
    /* Masquer les ic√¥nes de fallback */
    .fa-fallback {
        display: none;
    }
    
    /* Ic√¥nes sp√©cifiques */
    .btn-with-icon .fa-edit { color: #007bff; }
    .btn-with-icon .fa-trash { color: #dc3545; }
    .btn-with-icon .fa-plus { color: #28a745; }
    .btn-with-icon .fa-save { color: #17a2b8; }
    .btn-with-icon .fa-magic { color: #6f42c1; }
    .btn-with-icon .fa-comments { color: #fd7e14; }
    .btn-with-icon .fa-chart-bar { color: #20c997; }
    .btn-with-icon .fa-image { color: #e83e8c; }
    .btn-with-icon .fa-eye { color: #6c757d; }
    .btn-with-icon .fa-download { color: #28a745; }
    .btn-with-icon .fa-upload { color: #ffc107; }
    .btn-with-icon .fa-times { color: #6c757d; }
    .btn-with-icon .fa-home { color: #007bff; }
    .btn-with-icon .fa-bullseye { color: #dc3545; }
    .btn-with-icon .fa-users { color: #28a745; }
    .btn-with-icon .fa-tachometer-alt { color: #17a2b8; }
    </style>
</head>
                <body class="main-content">
                    <div class="header">
                        <h1>Commentaire LSU</h1>
                        <h2>√âCOLE DU CAP</h2>
                    </div>
                    <div class="info">
                        <strong>√âl√®ve :</strong> ${name}<br>
                        <strong>Niveau :</strong> ${level}<br>
                        <strong>P√©riode :</strong> ${period}
                    </div>
                    <div class="comment">
                        ${comment}
                    </div>
                    <!-- Script JavaScript pour la sidebar -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebar-toggle');
    const sidebarOverlay = document.getElementById('sidebar-overlay');
    const navLinks = document.querySelectorAll('.nav-link');

    // Fonction pour marquer la page active
    function setActivePage() {
        const currentPage = window.location.pathname.split('/').pop() || 'index.html';
        
        navLinks.forEach(link => {
            link.classList.remove('active');
            const href = link.getAttribute('href');
            if (href === currentPage) {
                link.classList.add('active');
            }
        });
    }

    // Fonction pour basculer la sidebar sur mobile
    function toggleSidebar() {
        sidebar.classList.toggle('open');
        sidebarOverlay.classList.toggle('hidden');
    }

    // √âv√©nements pour mobile
    if (sidebarToggle) {
        sidebarToggle.addEventListener('click', toggleSidebar);
    }
    
    if (sidebarOverlay) {
        sidebarOverlay.addEventListener('click', toggleSidebar);
    }

    // Fermer la sidebar en cliquant sur un lien (mobile)
    navLinks.forEach(link => {
        link.addEventListener('click', () => {
            if (window.innerWidth < 640) {
                toggleSidebar();
            }
        });
    });

    // Marquer la page active au chargement
    setActivePage();

    // Gestion du redimensionnement de fen√™tre
    window.addEventListener('resize', () => {
        if (window.innerWidth >= 640) {
            sidebar.classList.remove('open');
            sidebarOverlay.classList.add('hidden');
        }
    });
});
</script>
</body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
            
            showToastNotification('Export PDF lanc√© !', 'success');
        }

        function showToastNotification(message, type = 'success') {
            // Supprimer les notifications existantes
            const existingToasts = document.querySelectorAll('.toast-notification');
            existingToasts.forEach(toast => toast.remove());
            
            // Cr√©er la nouvelle notification
            const toast = document.createElement('div');
            toast.className = `toast-notification ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Afficher la notification
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Masquer apr√®s 3 secondes
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Gestion des √©l√®ves
        function loadStudentsList() {
            const container = document.getElementById('studentsList');
            
            if (students.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Aucun √©l√®ve enregistr√©. Cliquez sur "Ajouter un √©l√®ve" pour commencer.</p>';
                return;
            }

            container.innerHTML = students.map((student, index) => `
                <div class="student-card">
                    <div class="student-info">
                        <h3>${student.firstName} ${student.lastName}</h3>
                        <p>Niveau: ${student.level} | N√©(e) le: ${new Date(student.birthDate).toLocaleDateString('fr-FR')}</p>
                    </div>
                    <div class="student-actions">
                        <button class="btn-small btn-view" onclick="selectStudent(${index})">S√©lectionner</button>
                        <button class="btn-small btn-edit" onclick="editStudent(${index})">Modifier</button>
                        <button class="btn-small btn-delete" onclick="deleteStudent(${index})">Supprimer</button>
                    </div>
                </div>
            `).join('');
        }

        function openAddStudentModal() {
            document.getElementById('addStudentModal').style.display = 'block';
        }

        function closeAddStudentModal() {
            document.getElementById('addStudentModal').style.display = 'none';
            // Reset du formulaire
            document.getElementById('newStudentName').value = '';
            document.getElementById('newStudentLastName').value = '';
            document.getElementById('newStudentLevel').value = 'CP';
            document.getElementById('newStudentBirthDate').value = '';
        }

        function addStudent() {
            const firstName = document.getElementById('newStudentName').value.trim();
            const lastName = document.getElementById('newStudentLastName').value.trim();
            const level = document.getElementById('newStudentLevel').value;
            const birthDate = document.getElementById('newStudentBirthDate').value;

            if (!firstName || !lastName || !birthDate) {
                showNotification('Veuillez remplir tous les champs obligatoires', 'error');
                return;
            }

            const newStudent = {
                firstName,
                lastName,
                level,
                birthDate,
                createdAt: new Date().toISOString()
            };

            students.push(newStudent);
            localStorage.setItem('students', JSON.stringify(students));
            
            closeAddStudentModal();
            loadStudentsList();
            showNotification(`${firstName} ${lastName} a √©t√© ajout√©(e) avec succ√®s !`, 'success');
        }

        function selectStudent(index) {
            const student = students[index];
            
            // Basculer vers la page g√©n√©rateur
            showPage('generator');
            
            // Pr√©-remplir le formulaire
            document.getElementById('studentName').value = student.firstName;
            document.getElementById('studentLevel').value = student.level;
            
            showNotification(`√âl√®ve ${student.firstName} ${student.lastName} s√©lectionn√©(e)`, 'success');
        }

        function deleteStudent(index) {
            const student = students[index];
            if (confirm(`√ätes-vous s√ªr de vouloir supprimer ${student.firstName} ${student.lastName} ?`)) {
                students.splice(index, 1);
                localStorage.setItem('students', JSON.stringify(students));
                loadStudentsList();
                showNotification('√âl√®ve supprim√©(e) avec succ√®s', 'success');
            }
        }

        // Param√®tres et connexions
        function loadSettings() {
            const saved = localStorage.getItem('lsuConfig');
            if (saved) {
                config = { ...config, ...JSON.parse(saved) };
                document.getElementById('n8nUrl').value = config.n8nUrl;
                document.getElementById('apiKey').value = config.apiKey;
                document.getElementById('aiUrl').value = config.aiUrl;
                document.getElementById('aiModel').value = config.aiModel;
            }
            return config;
        }

        function saveSettings() {
            config.n8nUrl = document.getElementById('n8nUrl').value;
            config.apiKey = document.getElementById('apiKey').value;
            config.aiUrl = document.getElementById('aiUrl').value;
            config.aiModel = document.getElementById('aiModel').value;
            
            localStorage.setItem('lsuConfig', JSON.stringify(config));
            showNotification('Param√®tres sauvegard√©s avec succ√®s !', 'success');
            
            // Tester la connexion apr√®s sauvegarde
            testConnections();
        }

        async function testConnections() {
            let n8nStatus = false;
            let aiStatus = false;

            // Test N8N
            if (config.n8nUrl) {
                try {
                    const response = await fetch(config.n8nUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            ...(config.apiKey && { 'Authorization': `Bearer ${config.apiKey}` })
                        },
                        body: JSON.stringify({ test: true })
                    });
                    n8nStatus = response.ok;
                } catch (error) {
                    console.error('Erreur N8N:', error);
                }
            }

            // Test IA locale
            if (config.aiUrl) {
                try {
                    const response = await fetch(config.aiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            model: config.aiModel,
                            prompt: 'Test de connexion',
                            stream: false
                        })
                    });
                    aiStatus = response.ok;
                } catch (error) {
                    console.error('Erreur IA:', error);
                }
            }

            updateConnectionStatus(n8nStatus, aiStatus);
            
            if (n8nStatus && aiStatus) {
                showNotification('‚úÖ Toutes les connexions sont op√©rationnelles !', 'success');
            } else if (n8nStatus || aiStatus) {
                showNotification('‚ö†Ô∏è Certaines connexions sont indisponibles', 'warning');
            } else {
                showNotification('‚ùå Aucune connexion externe disponible', 'error');
            }
        }

        function updateConnectionStatus(n8nStatus, aiStatus) {
            const statusElement = document.getElementById('connectionStatus');
            const indicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');

            if (n8nStatus && aiStatus) {
                statusElement.className = 'connection-status status-connected';
                indicator.className = 'status-indicator indicator-green';
                statusText.textContent = 'Connect√© (N8N + IA)';
            } else if (aiStatus) {
                statusElement.className = 'connection-status status-connected';
                indicator.className = 'status-indicator indicator-green';
                statusText.textContent = 'IA locale connect√©e';
            } else if (n8nStatus) {
                statusElement.className = 'connection-status status-connected';
                indicator.className = 'status-indicator indicator-green';
                statusText.textContent = 'N8N connect√©';
            } else {
                statusElement.className = 'connection-status status-disconnected';
                indicator.className = 'status-indicator indicator-red';
                statusText.textContent = 'Mode hors ligne';
            }
        }

        function loadExample(type) {
            // Reset du formulaire
            document.getElementById('studentName').value = '';
            document.getElementById('studentLevel').value = 'CM1';
            document.getElementById('period').value = '2√®me trimestre';
            document.getElementById('specificPoints').value = '';
            
            // Reset des checkboxes
            document.querySelectorAll('.checkbox-item input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.querySelectorAll('.level-btn').forEach(btn => btn.classList.remove('active'));

            switch(type) {
                case 'excellent':
                    selectedLevel = 'excellent';
                    document.querySelector('[data-level="excellent"]').classList.add('active');
                    document.getElementById('participation').checked = true;
                    document.getElementById('autonomie').checked = true;
                    document.getElementById('progres').checked = true;
                    break;
                case 'progres':
                    selectedLevel = 'satisfactory';
                    document.querySelector('[data-level="satisfactory"]').classList.add('active');
                    document.getElementById('progres').checked = true;
                    document.getElementById('ecoute').checked = true;
                    break;
                case 'encourage':
                    selectedLevel = 'fragile';
                    document.querySelector('[data-level="fragile"]').classList.add('active');
                    document.getElementById('participation').checked = true;
                    document.getElementById('specificPoints').value = 'Il/elle montre de la bonne volont√© et souhaite progresser.';
                    break;
                case 'comportement':
                    selectedLevel = 'satisfactory';
                    document.querySelector('[data-level="satisfactory"]').classList.add('active');
                    document.getElementById('ecoute').checked = true;
                    document.getElementById('entraide').checked = true;
                    break;
            }
            
            showNotification('Exemple charg√© !', 'success');
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Sauvegarde automatique
        function saveFormData() {
            const formData = {
                studentName: document.getElementById('studentName').value,
                studentLevel: document.getElementById('studentLevel').value,
                period: document.getElementById('period').value,
                selectedLevel: selectedLevel,
                specificPoints: document.getElementById('specificPoints').value,
                checkedItems: Array.from(document.querySelectorAll('.checkbox-item input[type="checkbox"]:checked')).map(cb => cb.value)
            };
            localStorage.setItem('lsuFormData', JSON.stringify(formData));
        }

        function loadFormData() {
            const saved = localStorage.getItem('lsuFormData');
            if (saved) {
                const formData = JSON.parse(saved);
                document.getElementById('studentName').value = formData.studentName || '';
                document.getElementById('studentLevel').value = formData.studentLevel || '';
                document.getElementById('period').value = formData.period || '';
                document.getElementById('specificPoints').value = formData.specificPoints || '';
                
                if (formData.selectedLevel) {
                    selectedLevel = formData.selectedLevel;
                    document.querySelector(`[data-level="${formData.selectedLevel}"]`)?.classList.add('active');
                }
                
                formData.checkedItems?.forEach(value => {
                    const checkbox = document.querySelector(`input[value="${value}"]`);
                    if (checkbox) checkbox.checked = true;
                });
            }
        }

        // √âv√©nements de sauvegarde
        document.querySelectorAll('input, select, textarea').forEach(element => {
            element.addEventListener('change', saveFormData);
            element.addEventListener('input', saveFormData);
        });

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            showPage('generator');
            loadUrlParams();
            updateConnectionStatus();
            initStudentSearch(); // Initialiser la recherche d'√©l√®ve
        });

        // Fermer le modal en cliquant √† l'ext√©rieur
        window.onclick = function(event) {
            const modal = document.getElementById('addStudentModal');
            if (event.target === modal) {
                closeAddStudentModal();
            }
        }

        // ===== FONCTIONS DE RECHERCHE D'√âL√àVE =====

        /**
         * Initialise la recherche d'√©l√®ve
         */
        function initStudentSearch() {
            const searchInput = document.getElementById('studentSearch');
            const searchResults = document.getElementById('searchResults');
            
            if (!searchInput) return;
            
            // √âv√©nement de saisie pour la recherche
            searchInput.addEventListener('input', function() {
                const query = this.value.trim().toLowerCase();
                
                if (query.length < 2) {
                    hideSearchResults();
                    return;
                }
                
                const results = searchStudents(query);
                displaySearchResults(results);
            });
            
            // √âv√©nement de focus pour afficher les r√©sultats
            searchInput.addEventListener('focus', function() {
                const query = this.value.trim().toLowerCase();
                if (query.length >= 2) {
                    const results = searchStudents(query);
                    displaySearchResults(results);
                }
            });
            
            // Fermer les r√©sultats en cliquant √† l'ext√©rieur
            document.addEventListener('click', function(event) {
                if (!searchInput.contains(event.target) && !searchResults.contains(event.target)) {
                    hideSearchResults();
                }
            });
            
            // Navigation au clavier
            searchInput.addEventListener('keydown', function(event) {
                const results = document.querySelectorAll('.search-result-item');
                const selected = document.querySelector('.search-result-item.selected');
                
                switch(event.key) {
                    case 'ArrowDown':
                        event.preventDefault();
                        navigateSearchResults(results, selected, 1);
                        break;
                    case 'ArrowUp':
                        event.preventDefault();
                        navigateSearchResults(results, selected, -1);
                        break;
                    case 'Enter':
                        event.preventDefault();
                        if (selected) {
                            selectStudentFromSearch(selected.dataset.index);
                        }
                        break;
                    case 'Escape':
                        hideSearchResults();
                        break;
                }
            });
        }

        /**
         * Recherche les √©l√®ves selon la requ√™te
         * @param {string} query - Requ√™te de recherche
         * @returns {Array} - R√©sultats filtr√©s
         */
        function searchStudents(query) {
            return eleves.filter(eleve => 
                eleve.prenom.toLowerCase().includes(query) ||
                eleve.niveau.toLowerCase().includes(query) ||
                eleve.periode.toLowerCase().includes(query)
            ).slice(0, 5); // Limiter √† 5 r√©sultats
        }

        /**
         * Affiche les r√©sultats de recherche
         * @param {Array} results - R√©sultats √† afficher
         */
        function displaySearchResults(results) {
            const searchResults = document.getElementById('searchResults');
            
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="search-result-item">Aucun √©l√®ve trouv√©</div>';
                searchResults.classList.add('show');
                return;
            }
            
            searchResults.innerHTML = results.map((eleve, index) => `
                <div class="search-result-item" data-index="${index}" onclick="selectStudentFromSearch(${index})">
                    <div class="student-avatar">${eleve.prenom.charAt(0)}</div>
                    <div class="student-info">
                        <div class="student-name">${eleve.prenom}</div>
                        <div class="student-details">${eleve.niveau} ‚Ä¢ ${eleve.periode}</div>
                    </div>
                </div>
            `).join('');
            
            searchResults.classList.add('show');
        }

        /**
         * Cache les r√©sultats de recherche
         */
        function hideSearchResults() {
            const searchResults = document.getElementById('searchResults');
            searchResults.classList.remove('show');
        }

        /**
         * Navigation dans les r√©sultats avec les fl√®ches
         * @param {NodeList} results - √âl√©ments de r√©sultats
         * @param {Element} selected - √âl√©ment actuellement s√©lectionn√©
         * @param {number} direction - Direction (1 = bas, -1 = haut)
         */
        function navigateSearchResults(results, selected, direction) {
            if (results.length === 0) return;
            
            let nextIndex = 0;
            
            if (selected) {
                const currentIndex = Array.from(results).indexOf(selected);
                nextIndex = (currentIndex + direction + results.length) % results.length;
                selected.classList.remove('selected');
            }
            
            results[nextIndex].classList.add('selected');
            results[nextIndex].scrollIntoView({ block: 'nearest' });
        }

        /**
         * S√©lectionne un √©l√®ve depuis la recherche
         * @param {number} index - Index de l'√©l√®ve dans les r√©sultats
         */
        function selectStudentFromSearch(index) {
            const results = searchStudents(document.getElementById('studentSearch').value);
            const eleve = results[index];
            
            if (!eleve) return;
            
            // Remplir automatiquement les champs
            fillStudentData(eleve);
            
            // Masquer les r√©sultats
            hideSearchResults();
            
            // Vider le champ de recherche
            document.getElementById('studentSearch').value = '';
            
            // Notification de succ√®s
            showNotification(`√âl√®ve ${eleve.prenom} s√©lectionn√© !`, 'success');
        }

        /**
         * Remplit automatiquement les champs avec les donn√©es de l'√©l√®ve
         * @param {Object} eleve - Donn√©es de l'√©l√®ve
         */
        function fillStudentData(eleve) {
            // Remplir les champs de base
            document.getElementById('studentName').value = eleve.prenom;
            document.getElementById('studentLevel').value = eleve.niveau;
            document.getElementById('period').value = eleve.periode;
            
            // D√©finir le niveau g√©n√©ral selon les donn√©es
            setLevelFromData(eleve.niveauGeneral);
            
            // Cocher les points forts correspondants
            checkStrengthsFromData(eleve.pointsForts);
            
            // Sauvegarder les donn√©es
            saveFormData();
        }

        /**
         * D√©finit le niveau selon les donn√©es de l'√©l√®ve
         * @param {string} niveauGeneral - Niveau g√©n√©ral de l'√©l√®ve
         */
        function setLevelFromData(niveauGeneral) {
            // R√©initialiser tous les boutons
            document.querySelectorAll('.level-btn').forEach(btn => btn.classList.remove('active'));
            
            // Mapper le niveau g√©n√©ral vers les boutons
            let levelButton = null;
            
            if (niveauGeneral.includes('insuffisante')) {
                levelButton = document.querySelector('[data-level="insufficient"]');
                selectedLevel = 'insufficient';
            } else if (niveauGeneral.includes('fragile')) {
                levelButton = document.querySelector('[data-level="fragile"]');
                selectedLevel = 'fragile';
            } else if (niveauGeneral.includes('satisfaisante')) {
                levelButton = document.querySelector('[data-level="satisfactory"]');
                selectedLevel = 'satisfactory';
            } else if (niveauGeneral.includes('Tr√®s bonne') || niveauGeneral.includes('excellente')) {
                levelButton = document.querySelector('[data-level="excellent"]');
                selectedLevel = 'excellent';
            }
            
            if (levelButton) {
                levelButton.classList.add('active');
            }
        }

        /**
         * Coche les points forts selon les donn√©es de l'√©l√®ve
         * @param {Array} pointsForts - Points forts de l'√©l√®ve
         */
        function checkStrengthsFromData(pointsForts) {
            // R√©initialiser toutes les checkboxes
            document.querySelectorAll('.checkbox-item input[type="checkbox"]').forEach(cb => cb.checked = false);
            
            // Mapper les points forts vers les checkboxes
            const strengthMapping = {
                'Participation active': 'participation',
                'Autonomie': 'autonomie',
                'Progr√®s constants': 'progres',
                'Cr√©ativit√©': 'creativite',
                'Bonne √©coute': 'ecoute',
                'Esprit d\'entraide': 'entraide'
            };
            
            pointsForts.forEach(pointFort => {
                const checkboxId = strengthMapping[pointFort];
                if (checkboxId) {
                    const checkbox = document.getElementById(checkboxId);
                    if (checkbox) {
                        checkbox.checked = true;
                    }
                }
            });
        }
    </script>

    <script>
    // Script de d√©tection et correction des ic√¥nes manquantes
    document.addEventListener('DOMContentLoaded', function() {
        // Fonction pour d√©tecter si un emoji s'affiche correctement
        function isEmojiSupported(emoji) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.font = '16px Arial';
            ctx.fillText(emoji, 0, 16);
            const data = ctx.getImageData(0, 0, 16, 16).data;
            return data.some(pixel => pixel !== 0);
        }
        
        // V√©rifier et corriger les ic√¥nes
        function fixMissingIcons() {
            const emojiElements = document.querySelectorAll('.emoji-icon');
            
            emojiElements.forEach(element => {
                const emoji = element.textContent;
                if (!isEmojiSupported(emoji)) {
                    // Masquer l'emoji et afficher l'ic√¥ne Font Awesome
                    element.style.display = 'none';
                    const fallbackIcon = element.nextElementSibling;
                    if (fallbackIcon && fallbackIcon.classList.contains('fa-fallback')) {
                        fallbackIcon.style.display = 'inline-block';
                    }
                }
            });
        }
        
        // Ex√©cuter apr√®s un d√©lai pour laisser le temps au rendu
        setTimeout(fixMissingIcons, 100);
        
        // R√©ex√©cuter si n√©cessaire
        window.addEventListener('load', fixMissingIcons);
    });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Script JavaScript pour la sidebar -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebar-toggle');
    const sidebarOverlay = document.getElementById('sidebar-overlay');
    const navLinks = document.querySelectorAll('.nav-link');

    // Fonction pour marquer la page active
    function setActivePage() {
        const currentPage = window.location.pathname.split('/').pop() || 'index.html';
        
        navLinks.forEach(link => {
            link.classList.remove('active');
            const href = link.getAttribute('href');
            if (href === currentPage) {
                link.classList.add('active');
            }
        });
    }

    // Fonction pour basculer la sidebar sur mobile
    function toggleSidebar() {
        sidebar.classList.toggle('open');
        sidebarOverlay.classList.toggle('hidden');
    }

    // √âv√©nements pour mobile
    if (sidebarToggle) {
        sidebarToggle.addEventListener('click', toggleSidebar);
    }
    
    if (sidebarOverlay) {
        sidebarOverlay.addEventListener('click', toggleSidebar);
    }

    // Fermer la sidebar en cliquant sur un lien (mobile)
    navLinks.forEach(link => {
        link.addEventListener('click', () => {
            if (window.innerWidth < 640) {
                toggleSidebar();
            }
        });
    });

    // Marquer la page active au chargement
    setActivePage();

    // Gestion du redimensionnement de fen√™tre
    window.addEventListener('resize', () => {
        if (window.innerWidth >= 640) {
            sidebar.classList.remove('open');
            sidebarOverlay.classList.add('hidden');
        }
    });
});
</script>
</body>
</html>